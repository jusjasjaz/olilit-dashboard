import { Injectable } from '@angular/core'
import { Observable } from 'rxjs'
import { HttpClient, HttpHeaders } from '@angular/common/http'
import { Router } from '@angular/router'
import { environment } from 'src/environments/environment'

@Injectable()
export class PentestService {
  constructor(private http: HttpClient, private router: Router) {}

  get_token(): Observable<any> {
    return this.http.get(
      `${environment.endPoint}/Authentication/IV`,
      {
        headers: {
          'Content-Type': `application/json`,
          'client_id': 'PLeQe0dmm3gc9gnYlvftYy14H5aaCpr3',
          'client_secret': 'wJRz98PKuKGGeXQA',
          'grant_type': 'IVPlusTokenId'
        },
        responseType: 'text' as 'json',
      },
    )
  }

  request(value:any): Observable<any> {
    return this.http.get(
      `${environment.endPoint}/Service/Request`,
      {
        headers: {
          'Content-Type': `application/json`,
          'iv': localStorage.getItem('iv')!,
          'value': value,
          'Authorization':'Bearer ' + localStorage.getItem('token')!,
        },
        responseType: 'text' as 'json',
      },
    )
  }

  test(value:any): Observable<any> {
    return this.http.post(
      `${environment.endPoint}/TraxEncrypt`,
      {
        "Service":"auth",
        "Method":"login",
        "Username":"ralph.lopez.xentra@gmail.com",
        "Password": "Password@123"
      },
      {
        headers: {
          'Content-Type': `application/json`,
          'iv': localStorage.getItem('iv')!,
          'APIKey': 'XZ62V8SXGJZ3D726'
        },
        responseType: 'text' as 'json',
      },
    )
  }

}
